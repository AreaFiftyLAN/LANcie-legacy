<link href="/lib/components/paper-input/paper-autogrow-textarea.html" rel="import">
<link href="/lib/components/paper-input/paper-input-decorator.html" rel="import">
<link href="/lib/components/paper-input/paper-char-counter.html" rel="import">

<polymer-element name="create-account">
  <template>
    <link rel="stylesheet" href="/lib/styles/elements/lancie-create-account.css">
    <link rel="stylesheet" href="/lib/components/components-font-awesome/css/font-awesome.min.css" no-shim>   

    <!-- 
      API call to check if username alreay exists.
      Response:
        true - Username already exists
        false - Username is new
     -->
    <core-ajax auto id="checkUsernameAJAX" url="https://areafiftylan.nl/api/user/check/{{username}}" on-core-response="{{checkUsername}}" handleAs="json"></core-ajax>

    <core-ajax auto id="checkEmailAJAX" url="https://areafiftylan.nl/api/user/checkemail/{{email}}" on-core-response="{{checkEmail}}" handleAs="json"></core-ajax>

    <core-ajax
      id="autoCompleteAddress"
      url="http://api.postcodedata.nl/v1/postcode/?postcode={{zipcode}}&streetnumber={{number}}&ref=areafiftylan.nl&type=json"
      handleAs="json"
      on-core-response="{{autoCompleteAddress}}"></core-ajax>
    
    <h1>Ticket sales - 12/13/14 Juni 2015</h1>
    <div class="specification">
      <p>{{userhash}}</p><p>{{userId}}</p>
      Area FiftyLAN is hét nieuwe gaming event van de TU Delft. Op dit spectaculaire weekend evenement zijn alle studenten van harte welkom om hun favoriete games te komen spelen met medestudenten en vrienden. Naast het vriendschappelijk spelen van games zullen er heldhaftige toernooien plaatsvinden, waaronder in Fifa, League Of Legends en TrackMania.
    </div>

    <div class="progress-bar" vertical layout>
      <div class="progress-bar-description" horizontal layout around-justified>
        <div flex>Account</div>
        <div flex>Profile</div>
        <div flex>Pick-Up</div>
        <div flex>Payment</div>
        <div flex>Confirmation</div>
      </div>
      <paper-progress value="1" id="progress"></paper-progress>
    </div>
  
    <form action="#" method="POST" layout vertical>
      <core-animated-pages id="animatedpages" on-click="{{stuff}}" transitions="cross-fade-all">
        <section id="account">
          <lancie-input label="Username" value="{{username}}" id="username"></lancie-input>
          <lancie-input label="Password" value="{{password}}" type="password" id="password" on-blur="{{checkPassword}}"></lancie-input>
          <lancie-input label="Confirm password" value="{{cpassword}}" type="password" id="cpassword" on-blur="{{checkConfirmPassword}}"></lancie-input>
          <lancie-input label="Email" value="{{email}}" id="email" on-blur="{{checkEmail}}"></lancie-input>
          
          <!-- SHINY BUTTON -->
          <div class="buttons" horizontal end-justified layout center>
            <core-label class="terms" horizontal layout>
              <paper-checkbox for id="terms"></paper-checkbox>
              <div vertical layout>I accept the terms of agreement</div>
            </core-label>
            <paper-button raised disabled?="{{!($.username.isValid && $.password.isValid && $.cpassword.isValid && $.email.isValid && $.terms.checked)}}" on-click="{{pageNext}}">go to profile</paper-button>
          </div>
        </section>
  
        <section id="data">
          <div layout horizontal center>
            <label for="{{name}}" flex two>Firstname *</label>
            <div flex four horizontal layout>
              <paper-input-decorator flex four style="margin-right: 16px;" label="Firstname" value="{{name}}">
                <input is="core-input" value="{{name}}" on-blur="{{emptyCheck}}" required>
              </paper-input-decorator>
              
              <paper-input-decorator flex two label="Initials" value="{{initials}}">
                <input is="core-input" value="{{initials}}" on-blur="{{emptyCheck}}" required>
              </paper-input-decorator>
            </div>
          </div>
          <lancie-input label="Surname" id="surname" value="{{surname}}"></lancie-input>
          
          <div layout horizontal center style="height: 60px;" class="selection">
            <label for="" flex two>Gender *</label>
            <div flex four horizontal layout center>
              <i center class="fa fa-male fa-2x"></i>
                <paper-toggle-button id="gender" checked="{{gender}}"></paper-toggle-button>
              <i class="fa fa-female fa-2x"></i>
            </div>
          </div>

          <div layout horizontal center>
            <label for="{{name}}" flex two>Address *</label>
            <div flex four horizontal layout>
              <paper-input-decorator label="Zipcode" style="margin-right: 16px;" id="zipcodeDecorator">
                <input is="core-input" id="zipcode" value="{{zipcode}}" on-blur="{{getAddress}}" required>
              </paper-input-decorator>
              
              <paper-input-decorator label="Number" id="numberDecorator">
                <input is="core-input" id="number" value="{{number}}" on-blur="{{getAddress}}" required>
              </paper-input-decorator>
            </div>
          </div>

          <div layout horizontal center>
            <label flex two></label>
            <div flex four horizontal layout>
              <paper-input flex four style="margin-right: 16px;" disabled label="Street" value="{{address}}"></paper-input>
              <paper-input flex two disabled label="City" value="{{city}}"></paper-input>
            </div>
          </div>

          <div layout horizontal center style="height: 60px;" class="selection">
            <label for="" flex two>CH Member *</label>
            <div flex four horizontal layout center>
              <i center class="fa fa-close fa-2x"></i>
                <paper-toggle-button id="gender" checked="{{chmember}}"></paper-toggle-button>
              <i class="fa fa-check fa-2x"></i>
            </div>
          </div>

          <lancie-input label="Phone number" id="tel" value="{{tel}}"></lancie-input>

          <div layout horizontal center class="selection">
            <label for="" flex two>Notes</label>
            <div flex four horizontal layout center>
              <paper-input-decorator label="Remarks, Allergies, etc.">
                <paper-autogrow-textarea>
                  <textarea id="notes" maxlength="100" value="{{notes}}"></textarea>
                </paper-autogrow-textarea>
              </paper-input-decorator>
            </div>
          </div>
      
          <!-- SHINY BUTTON -->
          <div class="buttons" horizontal justified layout>
            <paper-button raised on-click="{{pagePrev}}">BACK</paper-button>
            <paper-button raised disabled?="{{!(name && initials && surname && zipcode && number && address && city && tel)}}" on-click="{{pageNext}} {{ajaxRequest}}">go to payment</paper-button>
          </div>
        </section>

        <section>
          dingen
        </section>

        <section>
          <div class="payment-table">
            <div class="table-head" horizontal layout>
              <div flex four>Description</div>
              <div>Amount</div>
            </div>

            <div class="table-row" horizontal layout>
              <div flex four>
                <div>Ticket Area FiftyLAN - 12/13/14 Juni 2015 - {{chmember ? "CH Discount" : "Normal"}}</div>
                <span class="desc">{{name}} {{surname}} - {{username}} - {{email}}</span>
              </div>
              <span>€ {{chmember ? "30,00" : "35,00"}}</span>
            </div>
            <div class="table-row" horizontal layout>
              <div flex four>
                <div>Transaction cost</div>
                <span class="desc">iDeal</span>
              </div>
              <span>€ 1,00</span>
            </div>

            <div class="table-footer" horizontal layout>
              <div flex four>Total</div>
              <span>€ {{chmember ? "28,50" : "31,00"}}</span>
            </div>
          </div>

          <!-- SHINY BUTTON -->
          <div class="buttons" horizontal justified layout>
            <paper-button raised on-click="{{pagePrev}}">BACK</paper-button>
          </div>
        </section>
        <!-- <section>
          <div>4</div>
        </section> -->
      </core-animated-pages>
    </form>
  </template>

  <script src="/lib/scripts/elements/lancie-create-account.js"></script>
</polymer-element>